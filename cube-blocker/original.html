<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="original.css" />
    <title>Document</title>
  </head>
  <body>
    <div class="controls">
      <p>
        <strong>Add cube</strong>: Left mouse click <br />
        <strong>Delete cube</strong>: Right mouse click <br />
        <strong>Rotate</strong>: Left and right arrow keys <br />
        <strong>Ascend / Descend</strong>: Up and down arrow keys
      </p>
    </div>
    <div class="container">
      <div class="floor" id="floor">
        <!--FLOOR TILES-->
        <div class="f x0 y0" data-x="0" data-y="0"></div>
        <div class="f x0 y1" data-x="0" data-y="50"></div>
        <div class="f x0 y2" data-x="0" data-y="100"></div>
        <div class="f x0 y3" data-x="0" data-y="150"></div>
        <div class="f x0 y4" data-x="0" data-y="200"></div>
        <div class="f x0 y5" data-x="0" data-y="250"></div>
        <div class="f x0 y6" data-x="0" data-y="300"></div>
        <div class="f x0 y7" data-x="0" data-y="350"></div>
        <div class="f x0 y8" data-x="0" data-y="400"></div>
        <div class="f x0 y9" data-x="0" data-y="450"></div>
        <div class="f x0 y10" data-x="0" data-y="500"></div>
        <div class="f x0 y11" data-x="0" data-y="550"></div>
        <div class="f x1 y0" data-x="50" data-y="0"></div>
        <div class="f x1 y1" data-x="50" data-y="50"></div>
        <div class="f x1 y2" data-x="50" data-y="100"></div>
        <div class="f x1 y3" data-x="50" data-y="150"></div>
        <div class="f x1 y4" data-x="50" data-y="200"></div>
        <div class="f x1 y5" data-x="50" data-y="250"></div>
        <div class="f x1 y6" data-x="50" data-y="300"></div>
        <div class="f x1 y7" data-x="50" data-y="350"></div>
        <div class="f x1 y8" data-x="50" data-y="400"></div>
        <div class="f x1 y9" data-x="50" data-y="450"></div>
        <div class="f x1 y10" data-x="50" data-y="500"></div>
        <div class="f x1 y11" data-x="50" data-y="550"></div>
        <div class="f x2 y0" data-x="100" data-y="0"></div>
        <div class="f x2 y1" data-x="100" data-y="50"></div>
        <div class="f x2 y2" data-x="100" data-y="100"></div>
        <div class="f x2 y3" data-x="100" data-y="150"></div>
        <div class="f x2 y4" data-x="100" data-y="200"></div>
        <div class="f x2 y5" data-x="100" data-y="250"></div>
        <div class="f x2 y6" data-x="100" data-y="300"></div>
        <div class="f x2 y7" data-x="100" data-y="350"></div>
        <div class="f x2 y8" data-x="100" data-y="400"></div>
        <div class="f x2 y9" data-x="100" data-y="450"></div>
        <div class="f x2 y10" data-x="100" data-y="500"></div>
        <div class="f x2 y11" data-x="100" data-y="550"></div>
        <div class="f x3 y0" data-x="150" data-y="0"></div>
        <div class="f x3 y1" data-x="150" data-y="50"></div>
        <div class="f x3 y2" data-x="150" data-y="100"></div>
        <div class="f x3 y3" data-x="150" data-y="150"></div>
        <div class="f x3 y4" data-x="150" data-y="200"></div>
        <div class="f x3 y5" data-x="150" data-y="250"></div>
        <div class="f x3 y6" data-x="150" data-y="300"></div>
        <div class="f x3 y7" data-x="150" data-y="350"></div>
        <div class="f x3 y8" data-x="150" data-y="400"></div>
        <div class="f x3 y9" data-x="150" data-y="450"></div>
        <div class="f x3 y10" data-x="150" data-y="500"></div>
        <div class="f x3 y11" data-x="150" data-y="550"></div>
        <div class="f x4 y0" data-x="200" data-y="0"></div>
        <div class="f x4 y1" data-x="200" data-y="50"></div>
        <div class="f x4 y2" data-x="200" data-y="100"></div>
        <div class="f x4 y3" data-x="200" data-y="150"></div>
        <div class="f x4 y4" data-x="200" data-y="200"></div>
        <div class="f x4 y5" data-x="200" data-y="250"></div>
        <div class="f x4 y6" data-x="200" data-y="300"></div>
        <div class="f x4 y7" data-x="200" data-y="350"></div>
        <div class="f x4 y8" data-x="200" data-y="400"></div>
        <div class="f x4 y9" data-x="200" data-y="450"></div>
        <div class="f x4 y10" data-x="200" data-y="500"></div>
        <div class="f x4 y11" data-x="200" data-y="550"></div>
        <div class="f x5 y0" data-x="250" data-y="0"></div>
        <div class="f x5 y1" data-x="250" data-y="50"></div>
        <div class="f x5 y2" data-x="250" data-y="100"></div>
        <div class="f x5 y3" data-x="250" data-y="150"></div>
        <div class="f x5 y4" data-x="250" data-y="200"></div>
        <div class="f x5 y5" data-x="250" data-y="250"></div>
        <div class="f x5 y6" data-x="250" data-y="300"></div>
        <div class="f x5 y7" data-x="250" data-y="350"></div>
        <div class="f x5 y8" data-x="250" data-y="400"></div>
        <div class="f x5 y9" data-x="250" data-y="450"></div>
        <div class="f x5 y10" data-x="250" data-y="500"></div>
        <div class="f x5 y11" data-x="250" data-y="550"></div>
        <div class="f x6 y0" data-x="300" data-y="0"></div>
        <div class="f x6 y1" data-x="300" data-y="50"></div>
        <div class="f x6 y2" data-x="300" data-y="100"></div>
        <div class="f x6 y3" data-x="300" data-y="150"></div>
        <div class="f x6 y4" data-x="300" data-y="200"></div>
        <div class="f x6 y5" data-x="300" data-y="250"></div>
        <div class="f x6 y6" data-x="300" data-y="300"></div>
        <div class="f x6 y7" data-x="300" data-y="350"></div>
        <div class="f x6 y8" data-x="300" data-y="400"></div>
        <div class="f x6 y9" data-x="300" data-y="450"></div>
        <div class="f x6 y10" data-x="300" data-y="500"></div>
        <div class="f x6 y11" data-x="300" data-y="550"></div>
        <div class="f x7 y0" data-x="350" data-y="0"></div>
        <div class="f x7 y1" data-x="350" data-y="50"></div>
        <div class="f x7 y2" data-x="350" data-y="100"></div>
        <div class="f x7 y3" data-x="350" data-y="150"></div>
        <div class="f x7 y4" data-x="350" data-y="200"></div>
        <div class="f x7 y5" data-x="350" data-y="250"></div>
        <div class="f x7 y6" data-x="350" data-y="300"></div>
        <div class="f x7 y7" data-x="350" data-y="350"></div>
        <div class="f x7 y8" data-x="350" data-y="400"></div>
        <div class="f x7 y9" data-x="350" data-y="450"></div>
        <div class="f x7 y10" data-x="350" data-y="500"></div>
        <div class="f x7 y11" data-x="350" data-y="550"></div>
        <div class="f x8 y0" data-x="400" data-y="0"></div>
        <div class="f x8 y1" data-x="400" data-y="50"></div>
        <div class="f x8 y2" data-x="400" data-y="100"></div>
        <div class="f x8 y3" data-x="400" data-y="150"></div>
        <div class="f x8 y4" data-x="400" data-y="200"></div>
        <div class="f x8 y5" data-x="400" data-y="250"></div>
        <div class="f x8 y6" data-x="400" data-y="300"></div>
        <div class="f x8 y7" data-x="400" data-y="350"></div>
        <div class="f x8 y8" data-x="400" data-y="400"></div>
        <div class="f x8 y9" data-x="400" data-y="450"></div>
        <div class="f x8 y10" data-x="400" data-y="500"></div>
        <div class="f x8 y11" data-x="400" data-y="550"></div>
        <div class="f x9 y0" data-x="450" data-y="0"></div>
        <div class="f x9 y1" data-x="450" data-y="50"></div>
        <div class="f x9 y2" data-x="450" data-y="100"></div>
        <div class="f x9 y3" data-x="450" data-y="150"></div>
        <div class="f x9 y4" data-x="450" data-y="200"></div>
        <div class="f x9 y5" data-x="450" data-y="250"></div>
        <div class="f x9 y6" data-x="450" data-y="300"></div>
        <div class="f x9 y7" data-x="450" data-y="350"></div>
        <div class="f x9 y8" data-x="450" data-y="400"></div>
        <div class="f x9 y9" data-x="450" data-y="450"></div>
        <div class="f x9 y10" data-x="450" data-y="500"></div>
        <div class="f x9 y11" data-x="450" data-y="550"></div>
        <div class="f x10 y0" data-x="500" data-y="0"></div>
        <div class="f x10 y1" data-x="500" data-y="50"></div>
        <div class="f x10 y2" data-x="500" data-y="100"></div>
        <div class="f x10 y3" data-x="500" data-y="150"></div>
        <div class="f x10 y4" data-x="500" data-y="200"></div>
        <div class="f x10 y5" data-x="500" data-y="250"></div>
        <div class="f x10 y6" data-x="500" data-y="300"></div>
        <div class="f x10 y7" data-x="500" data-y="350"></div>
        <div class="f x10 y8" data-x="500" data-y="400"></div>
        <div class="f x10 y9" data-x="500" data-y="450"></div>
        <div class="f x10 y10" data-x="500" data-y="500"></div>
        <div class="f x10 y11" data-x="500" data-y="550"></div>
        <div class="f x11 y0" data-x="550" data-y="0"></div>
        <div class="f x11 y1" data-x="550" data-y="50"></div>
        <div class="f x11 y2" data-x="550" data-y="100"></div>
        <div class="f x11 y3" data-x="550" data-y="150"></div>
        <div class="f x11 y4" data-x="550" data-y="200"></div>
        <div class="f x11 y5" data-x="550" data-y="250"></div>
        <div class="f x11 y6" data-x="550" data-y="300"></div>
        <div class="f x11 y7" data-x="550" data-y="350"></div>
        <div class="f x11 y8" data-x="550" data-y="400"></div>
        <div class="f x11 y9" data-x="550" data-y="450"></div>
        <div class="f x11 y10" data-x="550" data-y="500"></div>
        <div class="f x11 y11" data-x="550" data-y="550"></div>
      </div>
    </div>

    <script>
      (function () {
        var c = document.getElementById('cursor');
        var f = document.getElementById('floor');

        f.addEventListener('mousedown', clickHandle, false);
        window.addEventListener('keydown', keysdown, false);
        window.addEventListener('keyup', keysup, false);
        //DISABLE RIGHT CLICK MENUS
        window.addEventListener(
          'contextmenu',
          function (e) {
            e.preventDefault();
          },
          false
        );

        function clickHandle(e) {
          var sel = e.target;
          var pCube = sel.parentElement;
          //CLICK ON FLOOR TILE
          if (e.buttons === 1) {
            addCube();
          }
          if (e.buttons === 2) {
            deleteCube();
          }

          function addCube() {
            if (sel.classList.contains('f')) {
              var sx = sel.dataset.x;
              var sy = sel.dataset.y;
              var sz = 0;
              var newCube = {
                obj: createCube(sx, sy, sz),
                x: sx,
                y: sy,
                z: sz,
              };
            }

            //CLICK ON 'UP' WALL
            if (sel.classList.contains('u')) {
              var sx = pCube.dataset.x;
              var sy = pCube.dataset.y;
              var sz = parseInt(pCube.dataset.z, 10) + 50;
              addNewCube(sx, sy, sz);
            }
            //CLICK ON 'NORTH' WALL
            if (sel.classList.contains('n')) {
              var sx = pCube.dataset.x;
              var sy = parseInt(pCube.dataset.y, 10) - 50;
              var sz = pCube.dataset.z;
              addNewCube(sx, sy, sz);
            }
            //CLICK ON 'SOUTH' WALL
            if (sel.classList.contains('s')) {
              var sx = pCube.dataset.x;
              var sy = parseInt(pCube.dataset.y, 10) + 50;
              var sz = pCube.dataset.z;
              addNewCube(sx, sy, sz);
            }
            //CLICK ON 'EAST' WALL
            if (sel.classList.contains('e')) {
              var sx = parseInt(pCube.dataset.x, 10) + 50;
              var sy = pCube.dataset.y;
              var sz = pCube.dataset.z;
              addNewCube(sx, sy, sz);
            }
            //CLICK ON 'WEST' WALL
            if (sel.classList.contains('w')) {
              var sx = parseInt(pCube.dataset.x, 10) - 50;
              var sy = pCube.dataset.y;
              var sz = pCube.dataset.z;
              addNewCube(sx, sy, sz);
            }

            function addNewCube(sx, sy, sz) {
              var newCube = {
                obj: createCube(sx, sy, sz),
                x: sx,
                y: sy,
                z: sz,
              };
            }
          }

          function deleteCube() {
            if (pCube.parentNode === f) {
              //remove the cube DOM element
              pCube.parentNode.removeChild(pCube);
            }
          }
        }

        //Create a cube, add to DOM, return cube element
        function createCube(x, y, z) {
          var docFragment = document.createDocumentFragment();
          var cube = document.createElement('div');
          cube.setAttribute('class', 'cube');
          var w = [],
            i = 0;
          var sides = ['d', 'n', 'e', 'w', 's', 'u'];
          while (i < 6) {
            w[i] = document.createElement('div');
            w[i].setAttribute('class', 'w' + (i + 1) + ' ' + sides[i]);
            cube.appendChild(w[i]);
            i++;
          }
          cube.dataset.x = x;
          cube.dataset.y = y;
          cube.dataset.z = z;
          f.appendChild(cube);
          cube.style.left = x + 'px';
          cube.style.top = y + 'px';
          cube.style.transform = 'translateZ(' + z + 'px)';
          return cube;
        }

        var floor = {
          rotateZ: 0,
          translateZ: 0,
        };

        var keyManager = {
          leftArrow: false,
          rightArrow: false,
          upArrow: false,
          downArrow: false,
        };

        function keysdown(e) {
          if (e.which === 37) {
            keyManager.leftArrow = true;
          }
          if (e.which === 39) {
            keyManager.rightArrow = true;
          }
          if (e.which === 38) {
            keyManager.upArrow = true;
          }
          if (e.which === 40) {
            keyManager.downArrow = true;
          }
        }

        function keysup(e) {
          keyManager.leftArrow = false;
          keyManager.rightArrow = false;
          keyManager.upArrow = false;
          keyManager.downArrow = false;
        }

        function render() {
          requestAnimationFrame(render);

          if (keyManager.leftArrow) {
            floor.rotateZ--;
            f.style.transform =
              'rotateX(70deg) rotateZ(' +
              floor.rotateZ +
              'deg) translateZ(' +
              floor.translateZ +
              'px)';
          }
          if (keyManager.rightArrow) {
            floor.rotateZ++;
            f.style.transform =
              'rotateX(70deg) rotateZ(' +
              floor.rotateZ +
              'deg) translateZ(' +
              floor.translateZ +
              'px)';
          }
          if (keyManager.upArrow) {
            floor.translateZ -= 3;
            f.style.transform =
              'rotateX(70deg) rotateZ(' +
              floor.rotateZ +
              'deg) translateZ(' +
              floor.translateZ +
              'px)';
          }
          if (keyManager.downArrow) {
            floor.translateZ += 3;
            f.style.transform =
              'rotateX(70deg) rotateZ(' +
              floor.rotateZ +
              'deg) translateZ(' +
              floor.translateZ +
              'px)';
          }
        }

        render();
      })();
    </script>
  </body>
</html>
